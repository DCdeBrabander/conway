"use strict";(()=>{var l=class{constructor(e,t,i){this.x=0;this.y=0;this.size=0;this.updated=!1;this.alive=!0;this.aliveNeighbours=0;this.getCoordinateString=()=>`[${this.x}:${this.y}]`;this.setAliveNeighbours=e=>this.aliveNeighbours=e;this.x=e,this.y=t,this.alive=i}},d=l;var o=(t=>(t[t.PAUSED=0]="PAUSED",t[t.RUNNING=1]="RUNNING",t))(o||{}),h=class{constructor(e,t=10,i=3){this.grid=[];this.currentState=0;this.init=()=>{this.setGameState(0),window.addEventListener("resize",this.resizeCanvas,!1),this.resizeCanvas(),this.grid=this.getNewGrid(),requestAnimationFrame(this.draw)};this.resizeCanvas=()=>{this.canvasElement.width=this.roundToNearest(window.innerWidth),this.canvasElement.height=this.roundToNearest(window.innerHeight)};this.getNewGrid=()=>{let e=[];for(let t=0;t<=this.canvasElement?.width;t+=this.resolution){e[t]=[];for(let i=0;i<=this.canvasElement?.height;i+=this.resolution)e[t][i]=new d(t,i,!1)}return e};this.draw=()=>{this.clear(),this.drawCells(),this.currentState==1&&this.update(),setTimeout(()=>{requestAnimationFrame(this.draw)},1e3/this.fps)};this.update=()=>{let e=this.getNewGrid();this.grid.forEach((t,i)=>{t.forEach((s,n)=>{s.setAliveNeighbours(this.countAliveNeighboursForCell(s)),e[i][n].alive=this.isCellAlive(s)})}),this.grid=e};this.clear=()=>{this.canvasContext.clearRect(0,0,this.canvasElement.width,this.canvasElement.height),this.canvasContext.fillStyle="black",this.canvasContext.fillRect(0,0,this.canvasElement.width,this.canvasElement.height)};this.isCellAlive=e=>{let t=e.alive;return e.aliveNeighbours=this.countAliveNeighboursForCell(e),e.alive?e.aliveNeighbours===2||e.aliveNeighbours===3?t=!0:t=!1:e.aliveNeighbours===3&&(t=!0),t};this.setGameState=e=>this.currentState=e;this.drawCells=()=>this.grid.forEach(e=>e.forEach((t,i)=>t.alive&&this.drawCell(t)));this.drawCell=e=>{this.canvasContext.fillStyle="white",this.canvasContext.fillRect(e.x,e.y,this.resolution,this.resolution)};this.toggleCellAtCoordinate=(e,t)=>{let i=this.roundToNearest(e),s=this.roundToNearest(t),n=this.getCellAt(i,s);this.getCellAt(i,s)&&(n.alive=!n.alive)};this.countAliveNeighboursForCell=e=>{let t=0,i=this.resolution,{x:s,y:n}=e,C=[this.getOverflowCoordinate(s-i,n-i),this.getOverflowCoordinate(s,n-i),this.getOverflowCoordinate(s+i,n-i),this.getOverflowCoordinate(s-i,n),this.getOverflowCoordinate(s+i,n),this.getOverflowCoordinate(s-i,n+i),this.getOverflowCoordinate(s,n+i),this.getOverflowCoordinate(s+i,n+i)];for(let u of C)this.getCellAt(u.x,u.y).alive&&t++;return t};this.getCellAt=(e,t)=>this.grid[e][t];this.roundToNearest=(e,t=this.resolution)=>Math.floor(e/t)*t;this.getOverflowCoordinate=(e,t)=>{let i={x:e,y:t};return e<0?i.x=this.roundToNearest(this.canvasElement.width-this.resolution):e>this.canvasElement.width&&(i.x=0),t<0?i.y=this.roundToNearest(this.canvasElement.height-this.resolution):t>this.canvasElement.height&&(i.y=0),i};this.canvasElement=e,this.canvasContext=this.canvasElement.getContext("2d"),this.resolution=t,this.fps=i,this.init()}},v=h;var m=20,g=5,c=document.getElementById("conway-canvas"),a=new v(c,m,g);c.addEventListener("mousedown",r=>{a.toggleCellAtCoordinate(r.clientX,r.clientY)},!1);window.addEventListener("keyup",r=>{switch(r.key.toLowerCase()){case"p":a.setGameState(0);break;case" ":a.setGameState(a.currentState==1?0:1);break;default:break}document.title="Conway - "+Object.keys(o)[Object.values(o).indexOf(a.currentState)]},!1);})();
